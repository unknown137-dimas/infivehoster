version: '3.5'
services:
  web-server: 
    image: nginx
    volumes:
      - ../frontend/:/usr/share/nginx/html:ro
      - ./default.conf:/etc/nginx/conf.d/default.conf
    restart: unless-stopped
    networks:
      - ifiver-network
  backend-server:
    image: app-api
    restart: unless-stopped
    networks:
      - ifiver-network
    expose:
      - 8080
  landing-page:
    image: app-tunnel
    entrypoint: lt --port 80 --subdomain 'ifiver'
    restart: unless-stopped
    network_mode: host
    networks:
      - ifiver-network
  dashboard:
    image: app-tunnel
    entrypoint: lt --port 9869 --subdomain 'dashboard-ifiver'
    restart: unless-stopped
    network_mode: host
    networks:
      - ifiver-network
  backend:
    image: app-tunnel
    entrypoint: lt --port 8080 --subdomain 'api-ifiver'
    restart: unless-stopped
    network_mode: host
    networks:
      - ifiver-network

networks:
  ifiver-network:
    external:
      True